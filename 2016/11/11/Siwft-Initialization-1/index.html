<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"xjshi.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.8.1","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="初始化的过程包括为每一个存储属性设置一个初始值和其他步骤。通过定义构造函数来实现初始化的过程，跟oc的初始化函数不同，Swift的构造函数不返回一个值。它们的主要角色是确保一个类型的实例在初次使用前被正确的初始化。">
<meta property="og:type" content="article">
<meta property="og:title" content="Siwft: Initialization-1">
<meta property="og:url" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/index.html">
<meta property="og:site_name" content="land">
<meta property="og:description" content="初始化的过程包括为每一个存储属性设置一个初始值和其他步骤。通过定义构造函数来实现初始化的过程，跟oc的初始化函数不同，Swift的构造函数不返回一个值。它们的主要角色是确保一个类型的实例在初次使用前被正确的初始化。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/pic/designated_initializer_syntax.png">
<meta property="og:image" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/pic/convenience_initializer_syntax.png">
<meta property="og:image" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/pic/initializer_delegation_rules.png">
<meta property="og:image" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/pic/RecipeIngredient.png">
<meta property="og:image" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/pic/ShoppingListItem.png">
<meta property="article:published_time" content="2016-11-11T18:12:05.000Z">
<meta property="article:modified_time" content="2023-12-13T12:25:29.685Z">
<meta property="article:author" content="ebebya">
<meta property="article:tag" content="Swift">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/pic/designated_initializer_syntax.png">


<link rel="canonical" href="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/","path":"2016/11/11/Siwft-Initialization-1/","title":"Siwft: Initialization-1"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Siwft: Initialization-1 | land</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">land</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Setting-Initial-Values-for-Stored-Properties"><span class="nav-number">1.</span> <span class="nav-text">Setting Initial Values for Stored Properties</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Initializers%EF%BC%88%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%EF%BC%89"><span class="nav-number">1.1.</span> <span class="nav-text">Initializers（构造函数）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Customizing-Initialization%EF%BC%88%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0%EF%BC%89"><span class="nav-number">2.</span> <span class="nav-text">Customizing Initialization（自定义初始化函数）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Initialization-Parameters"><span class="nav-number">2.1.</span> <span class="nav-text">1. Initialization Parameters</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Parameter-Names-and-Argument-Labels"><span class="nav-number">2.1.1.</span> <span class="nav-text">Parameter Names and Argument Labels</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Initializer-Parameters-Without-Argument-Labels"><span class="nav-number">2.1.2.</span> <span class="nav-text">Initializer Parameters Without Argument Labels</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Optional-Property-Types"><span class="nav-number">2.2.</span> <span class="nav-text">2. Optional Property Types</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Assigning-Constant-Properties-During-Initialization"><span class="nav-number">2.3.</span> <span class="nav-text">3. Assigning Constant Properties During Initialization</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Default-Initializers%EF%BC%88%E9%BB%98%E8%AE%A4%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">Default Initializers（默认构造函数）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Memberwise-Initializers-for-Structure-Types"><span class="nav-number">3.1.</span> <span class="nav-text">Memberwise Initializers for Structure Types</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Initializer-Delegation-for-Value-Types"><span class="nav-number">4.</span> <span class="nav-text">Initializer Delegation for Value Types</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Class-Inheritance-and-Initialization"><span class="nav-number">5.</span> <span class="nav-text">Class Inheritance and Initialization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Syntax-for-Designated-and-Convenience-Initializers"><span class="nav-number">5.1.</span> <span class="nav-text">Syntax for Designated and Convenience Initializers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Initializer-Delegation-for-Class-Types"><span class="nav-number">5.2.</span> <span class="nav-text">Initializer Delegation for Class Types</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Two-Phase-Initialization"><span class="nav-number">5.3.</span> <span class="nav-text">Two-Phase Initialization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Initializer-Inheritance-and-Overriding"><span class="nav-number">5.4.</span> <span class="nav-text">Initializer Inheritance and Overriding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Automatic-Initializer-Inheritance"><span class="nav-number">5.5.</span> <span class="nav-text">Automatic Initializer Inheritance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Designated-and-Convenience-Initializer-in-Action"><span class="nav-number">5.6.</span> <span class="nav-text">Designated and Convenience Initializer in Action</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ebebya</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xjshi.github.io/2016/11/11/Siwft-Initialization-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ebebya">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="land">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Siwft: Initialization-1
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-11-11 18:12:05" itemprop="dateCreated datePublished" datetime="2016-11-11T18:12:05+00:00">2016-11-11</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>初始化的过程包括为每一个存储属性设置一个初始值和其他步骤。通过定义构造函数来实现初始化的过程，跟oc的初始化函数不同，Swift的构造函数不返回一个值。它们的主要角色是确保一个类型的实例在初次使用前被正确的初始化。</p>
<span id="more"></span>
<p>类的实例也可以有析构函数，析构函数在类的实例在释放前完成一些清理工作。</p>
<h2 id="Setting-Initial-Values-for-Stored-Properties"><a href="#Setting-Initial-Values-for-Stored-Properties" class="headerlink" title="Setting Initial Values for Stored Properties"></a>Setting Initial Values for Stored Properties</h2><p>类和结构体必须为它们所有的存储属性设置一个初始值，在类或结构体的实例创建完成前。存储属性不能是不确定的状态。</p>
<p>可以通过构造函数或默认值的方式给存储属性一个初始值，而且通过这两种方式，属性的值都是被直接设置，不会调用属性观察者。</p>
<h3 id="Initializers（构造函数）"><a href="#Initializers（构造函数）" class="headerlink" title="Initializers（构造函数）"></a>Initializers（构造函数）</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">init</span>()</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Customizing-Initialization（自定义初始化函数）"><a href="#Customizing-Initialization（自定义初始化函数）" class="headerlink" title="Customizing Initialization（自定义初始化函数）"></a>Customizing Initialization（自定义初始化函数）</h2><p>你可以自定义初始化过程，通过使用输入参数，可选的属性类型，或者在初始化期间给常量属性赋值。具体描述在下面的部分中描述。</p>
<h3 id="1-Initialization-Parameters"><a href="#1-Initialization-Parameters" class="headerlink" title="1. Initialization Parameters"></a>1. Initialization Parameters</h3><p>你可以为构造函数提供参数，看个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Celsius</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temperatureInCelsius: <span class="type">Double</span></span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">fromFahrenheit</span> <span class="params">fahrenheit</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        temperatureInCelsius <span class="operator">=</span> (fahrenheit <span class="operator">-</span> <span class="number">32.0</span>) <span class="operator">/</span> <span class="number">1.8</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">fromKelvin</span> <span class="params">kelvin</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        temperatureInCelsius <span class="operator">=</span> kelvin <span class="operator">-</span> <span class="number">273.15</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">celsius</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        temperatureInCelsius <span class="operator">=</span> celsius</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> boilingPointOfWater <span class="operator">=</span> <span class="type">Celsius</span>(fromFahrenheit: <span class="number">212.0</span>)</span><br><span class="line"><span class="keyword">let</span> freezingPointOfWater <span class="operator">=</span> <span class="type">Celsius</span>(fromKelvin: <span class="number">273.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bodyTemperature <span class="operator">=</span> <span class="type">Celsius</span>(<span class="number">37.0</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Parameter-Names-and-Argument-Labels"><a href="#Parameter-Names-and-Argument-Labels" class="headerlink" title="Parameter Names and Argument Labels"></a>Parameter Names and Argument Labels</h4><p>Swift provides an autoamtic argument label for every parameter in an initializer if you don’t provide one.看个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> red, green, blue: <span class="type">Double</span></span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">red</span>: <span class="type">Double</span>, <span class="params">green</span>: <span class="type">Double</span>, <span class="params">blue</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.red <span class="operator">=</span> red</span><br><span class="line">        <span class="keyword">self</span>.green <span class="operator">=</span> green</span><br><span class="line">        <span class="keyword">self</span>.blue <span class="operator">=</span> blue</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">white</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">        red <span class="operator">=</span> white</span><br><span class="line">        green <span class="operator">=</span> white</span><br><span class="line">        blue <span class="operator">=</span> white</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以这样初始化一个<code>Color</code>的实例：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> megenta <span class="operator">=</span> <span class="type">Color</span>(red: <span class="number">1.0</span>, green: <span class="number">0.0</span>, blue: <span class="number">1.0</span>)</span><br><span class="line"><span class="keyword">let</span> halfGray <span class="operator">=</span> <span class="type">Color</span>(white: <span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Initializer-Parameters-Without-Argument-Labels"><a href="#Initializer-Parameters-Without-Argument-Labels" class="headerlink" title="Initializer Parameters Without Argument Labels"></a>Initializer Parameters Without Argument Labels</h4><p>参考上边<code>Celsius</code>类中的第三个构造方法，及<code>bodyTemperature</code>的初始化。</p>
<h3 id="2-Optional-Property-Types"><a href="#2-Optional-Property-Types" class="headerlink" title="2. Optional Property Types"></a>2. Optional Property Types</h3><p>如果你自定义的类型有一个存储属性在逻辑上允许“没有值”——或许是因为在初始化期间不能设置设置它的值，也可能是在后边的某个时间点允许它“没有值”，那么可以把这个属性声明为<em>optional type</em>。optional type的属性被自动初始化为<code>nil</code>。原文如下：</p>
<p>“If your custom type has a stored property that is logically allowed to have “no value”—perhaps because its value cannot be set during initialization, or because it is allowed to have “no value” at some later point—declare the property with an optional type. Properties of optional type are automatically initialized with a value of nil, indicating that the property is deliberately intended to have “no value yet” during initialization.”</p>
<p>Excerpt From: Apple Inc. “The Swift Programming Language (Swift 3).” iBooks. </p>
<p>看下下边这个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SurveyQuestion</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> text: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> response: <span class="type">String</span>?</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">text</span>: <span class="type">String</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.text <span class="operator">=</span> text</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ask</span>()</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cheeseQuestion <span class="operator">=</span> <span class="type">SurveyQuestion</span>(text: <span class="string">&quot;Do you like cheese&quot;</span>)</span><br><span class="line">cheeseQuestion.ask()</span><br><span class="line">cheeseQuestion.response <span class="operator">=</span> <span class="string">&quot;YES, i do like chesse.&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="3-Assigning-Constant-Properties-During-Initialization"><a href="#3-Assigning-Constant-Properties-During-Initialization" class="headerlink" title="3. Assigning Constant Properties During Initialization"></a>3. Assigning Constant Properties During Initialization</h3><p>你可以在初始化期间给一个常量属性赋一个值，只要在初始化完成时有一个明确的值就可以。</p>
<p>注意：对于类的实例，常量属性只能由引入该属性的类在初始化期间修改，不能被子类修改。</p>
<p>可以在上边那个类稍作修改，观察text属性：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SurveyQuestion</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> text: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> response: <span class="type">String</span>?</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">text</span>: <span class="type">String</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.text <span class="operator">=</span> text</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ask</span>()</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cheeseQuestion <span class="operator">=</span> <span class="type">SurveyQuestion</span>(text: <span class="string">&quot;Do you like cheese&quot;</span>)</span><br><span class="line">cheeseQuestion.ask()</span><br><span class="line">cheeseQuestion.response <span class="operator">=</span> <span class="string">&quot;YES, i do like chesse.&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="Default-Initializers（默认构造函数）"><a href="#Default-Initializers（默认构造函数）" class="headerlink" title="Default Initializers（默认构造函数）"></a>Default Initializers（默认构造函数）</h2><p>在类或结构体为每个属性提供默认值并且没有其他构造函数时，Swift提供默认构造函数。默认构造函数简单的创建一个实例并把其所有属性设置成默认值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShoppingList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> quantity <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">var</span> purchased <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> item <span class="operator">=</span> <span class="type">ShoppingList</span>()</span><br></pre></td></tr></table></figure>
<p>上面的例子中，如果我们不给<code>quantity</code>设置默认值，编译器将提示<code>ShoppingList</code>类没有构造函数。</p>
<h3 id="Memberwise-Initializers-for-Structure-Types"><a href="#Memberwise-Initializers-for-Structure-Types" class="headerlink" title="Memberwise Initializers for Structure Types"></a>Memberwise Initializers for Structure Types</h3><p>结构体类型如果没有自定义的构造函数，那么会有一个<em>memberwise initializer</em>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Size</span> </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> width <span class="operator">=</span> <span class="number">0.0</span>, height <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> twoByTwo <span class="operator">=</span> <span class="type">Size</span>(width: <span class="number">2.0</span>, height: <span class="number">2.0</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Initializer-Delegation-for-Value-Types"><a href="#Initializer-Delegation-for-Value-Types" class="headerlink" title="Initializer Delegation for Value Types"></a>Initializer Delegation for Value Types</h2><p>Initializers can call other initializers to perform part of an instance’s initialization. This process, known as <em>initializer delegation</em>, avoids duplicating code across multiple initializers.</p>
<p>对于值类型，可以使用<code>self.init</code>来引用该类型的其他构造函数。<code>self.init</code>只能在构造函数内使用。看个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Size</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> width <span class="operator">=</span> <span class="number">0.0</span>, height <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x <span class="operator">=</span> <span class="number">0.0</span>, y <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rect</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> size <span class="operator">=</span> <span class="type">Size</span>()</span><br><span class="line">    <span class="keyword">var</span> point <span class="operator">=</span> <span class="type">Point</span>()</span><br><span class="line">    <span class="function"><span class="keyword">init</span>()</span> &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">size</span>: <span class="type">Size</span>, <span class="params">point</span>: <span class="type">Point</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.size <span class="operator">=</span> size</span><br><span class="line">        <span class="keyword">self</span>.point <span class="operator">=</span> point</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">size</span>: <span class="type">Size</span>, <span class="params">center</span>: <span class="type">Point</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> originX <span class="operator">=</span> center.x <span class="operator">-</span> size.width <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">let</span> originY <span class="operator">=</span> center.y <span class="operator">-</span> size.height <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(size: size, point: <span class="type">Point</span>(x: originX, y: originY))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面例子中第一个构造函数其实就相当于默认构造函数，第二个相当于memberwise initializer，第三个是完全自定义的。这个例子还有一种写法，可以不写<code>init()</code>和<code>init(size:point:)</code>，需要用到extension。</p>
<p>如果为值类型自定义了一个构造函数，那就不能再访问默认构造函数了。如果你想要你定义的值类型既可以使用默认构造函数，也可以使用自定义的构造函数，那需要把自定义的构造函数写在extension中。</p>
<h2 id="Class-Inheritance-and-Initialization"><a href="#Class-Inheritance-and-Initialization" class="headerlink" title="Class Inheritance and Initialization"></a>Class Inheritance and Initialization</h2><p>一个类所有的存储属性包括从父类继承的属性，都以徐在初始化几千有一个初始值。</p>
<p>Swift为类类型定义了两种类型的构造函数来确保存储属性有一个初始值，分别是<em>designated initializer</em>和<em>convenience initializer</em>。在下面的讨论中，我们分别把这两种称为指定构造函数、便利构造函数。</p>
<p>每个类都必须至少有一个指定构造函数。在一些条件下，这个需求通过从父类继承指定构造函数来满足。</p>
<p>便利构造函数可以调用该类中的指定构造函数。</p>
<h3 id="Syntax-for-Designated-and-Convenience-Initializers"><a href="#Syntax-for-Designated-and-Convenience-Initializers" class="headerlink" title="Syntax for Designated and Convenience Initializers"></a>Syntax for Designated and Convenience Initializers</h3><p>指定构造函数的语法：</p>
<p><img src="./pic/designated_initializer_syntax.png" alt="Designated Initalizer"></p>
<p>便利构造函数的语法：</p>
<p><img src="./pic/convenience_initializer_syntax.png" alt="Convenience Initializer"></p>
<h3 id="Initializer-Delegation-for-Class-Types"><a href="#Initializer-Delegation-for-Class-Types" class="headerlink" title="Initializer Delegation for Class Types"></a>Initializer Delegation for Class Types</h3><p>为了简化指定构造函数与遍历构造函数之间的关系，Swift在构造函数间的delegation call上使用下边三条规则：</p>
<ol>
<li>A designated initializer must call a designated initializer from its immediate superclass.</li>
<li>A convenience initializer must call another initializer from the same class.</li>
<li>A convenience initiazlier must ultimately call a designated initializer.</li>
</ol>
<p>可以简单的这样记：</p>
<ul>
<li>Designated initializers must always delegate up.</li>
<li>Convenience initiazlizers must always delegate across.</li>
</ul>
<p>这里有一个示意图来说明上面描述的规则：</p>
<p><img src="./pic/initializer_delegation_rules.png" alt="initializer_delegation_rules"></p>
<h3 id="Two-Phase-Initialization"><a href="#Two-Phase-Initialization" class="headerlink" title="Two-Phase Initialization"></a>Two-Phase Initialization</h3><p>在Swift中类的初始化分为两个阶段。在第一个阶段，类的每一个存储属性由引入其的类赋一个初始值，一旦每一个存储属性的初始状态确定了，第二个几段就开始了。第二个阶段开始以后，每个类在类可以使用前都有机会给每一个存储属性进行进一步自定义。</p>
<p>跟oc中的初始化有些许不同，主要体现在第一个阶段，在第一个阶段中，oc给每一个属性赋0值（如0、nil）。</p>
<p>Swift的编译器执行四步安全性检查(safaty-check)来确保两个阶段的初始化没有问题：</p>
<ol>
<li><strong>A designated initializer must ensure that all of the properties introduced by its class are initizlied before it delegates up to a superclass initializer.</strong></li>
<li><strong>A designated initializer must delegate up to a superclass initializer before assigning a value to an inherited property.</strong> If it doesn’t, the new value the designated initializer assigns will be overwritten by the superclass as part of its own initialization.</li>
<li><strong>A convenience initializer must delegate to another initializer before assigning a value to any property.</strong> If it doesn’t, the new value the convenience initializer assigns will be overwritten by its own class’s designated initializer.</li>
<li><strong>An initializer cannot call any instance methods, read the value of any instance properties, or refer to <code>self</code> as a value until after the first phase of initialization is complete.</strong></li>
</ol>
<h3 id="Initializer-Inheritance-and-Overriding"><a href="#Initializer-Inheritance-and-Overriding" class="headerlink" title="Initializer Inheritance and Overriding"></a>Initializer Inheritance and Overriding</h3><p>跟oc不同，Swift中的子类默认不继承父类的构造方法。当你为子类定义了一个构造方法，这个构造方法match一个父类的指定构造方法，你实际上是对那个指定构造方法进行了重写。因此，自己在子类构造方法前边用<code>override</code>标记。这个原则对于默认构造方法也适用。看个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> numberOfWheels <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;<span class="subst">\(numberOfWheels)</span> wheel(s)&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bicycle</span> : <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">init</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        numberOfWheels <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Automatic-Initializer-Inheritance"><a href="#Automatic-Initializer-Inheritance" class="headerlink" title="Automatic Initializer Inheritance"></a>Automatic Initializer Inheritance</h3><p>正如上边提到的，默认情况下，子类不继承弗雷德构造方法。但是，在满足一些条件的前提下，父类的构造方法可以被自动继承。</p>
<p>假设你已经为子类新引入的属性提供了默认值，那么有下面两条规则适用：</p>
<ol>
<li>如果子类没有定义任何指定构造方法，那么子类会自动继承父类所有的指定构造方法。</li>
<li>如果子类提供了父类所有指定构造方法（不论是规则1提到的，还是通过自定义实现），那么子类自动继承父类所有的便利构造方法。<strong>需要注意，子类可以把父类指定构造方法实现为便利构造方法，这样也可以满足这个条件</strong></li>
</ol>
<p>这些规则即使在子类添加了便利构造方法时，依然适用。</p>
<h3 id="Designated-and-Convenience-Initializer-in-Action"><a href="#Designated-and-Convenience-Initializer-in-Action" class="headerlink" title="Designated and Convenience Initializer in Action"></a>Designated and Convenience Initializer in Action</h3><p>在这一部分，我们通过一个例子来解释上边的两条规则。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="comment">//指定构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;super versioin&quot;</span>)</span><br><span class="line">        <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//便利构造方法</span></span><br><span class="line">    <span class="keyword">convenience</span> <span class="function"><span class="keyword">init</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: <span class="string">&quot;[Unnamed]&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RecipeIngredient</span>: <span class="title">Food</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> quantity: <span class="type">Int</span></span><br><span class="line">    <span class="function"><span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>, <span class="params">quantity</span>: <span class="type">Int</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.quantity <span class="operator">=</span> quantity</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">convenience</span> <span class="function"><span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;sub version&quot;</span>)</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: name, quantity: <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在这两个类的构造方法可以用下标的图来清楚的展示：</p>
<p><img src="./pic/RecipeIngredient.png" alt="RecipeIngredient"></p>
<p>我们直接看一下<code>RecipeIngredient</code>类，首先有一个自定义的指定构造方法<code>init(name:quantity:)</code>，然后有一个自定义的便利构造方法<code>init(name:)</code>，这个方法实际上是重写了<code>Food</code>类的唯一的一个指定构造方法，所以满足了上面的第二条原则，因此自动继承<code>Food</code>类所有的便利构造方法，即<code>init()</code>方法。这里需要注意的是，<code>RecipeIngredient</code>继承来的<code>init()</code>方法中，调用的<code>init(name:)</code>不是<code>Food</code>版本的，而是<code>RecipeIngredient</code>版本的。</p>
<p>现在再来定义一个类：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShoppingListItem</span>: <span class="title">RecipeIngredient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> purchased <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> output <span class="operator">=</span> <span class="string">&quot;<span class="subst">\(quantity)</span> * <span class="subst">\(name)</span>&quot;</span></span><br><span class="line">        output <span class="operator">+=</span> purchased <span class="operator">?</span> <span class="string">&quot;✔️&quot;</span> : <span class="string">&quot;❌&quot;</span></span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为<code>ShoppingListItem</code>本身没有定义任何的构造方法，因此它从父类继承所有的构造方法。此时，示意图如下：</p>
<p><img src="./pic/ShoppingListItem.png" alt="ShoppingListItem"></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Swift/" rel="tag"># Swift</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2016/11/11/Swift-Inheritance/" rel="prev" title="Swift: Inheritance">
                  <i class="fa fa-chevron-left"></i> Swift: Inheritance
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2016/11/11/Swift-Initialization-2/" rel="next" title="Swift: Initialization-2">
                  Swift: Initialization-2 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ebebya</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
